"0","#| eval: !expr params$run"
"0",""
"0","# create plot for pooled main effects with income interactions"
"0",""
"0","list_dfs <- list(df_mod1_fixefs, df_mod_libind_fixefs)"
"0",""
"0","p_list <- "
"0","  lapply(1:length(list_dfs),"
"0","         function(z){"
"0","           "
"0","           df_pooled <- list_dfs[[z]] %>% "
"0","             separate(term, into = c(""first"", ""second""), sep = ""_"") %>% "
"0","             filter(if_any(c(""first"", ""second""),"
"0","                           .fns = function(x) x %in% c(NA, ""income""))) %>% "
"0","             mutate(holder = """","
"0","                    second = ifelse(is.na(second), ""main effects"","
"0","                                    ""income interactions"") %>% "
"0","                      factor(levels = c(""main effects"", ""income interactions"")),"
"0","                    type = ifelse(z==1, ""pooled"", ""index""))"
"0","           "
"0","           if(z==1){"
"0","             "
"0","             df_pooled <- "
"0","               df_pooled %>% "
"0","               mutate(first = factor(first, "
"0","                                     levels = dimensions$var_label))"
"0","             "
"0","           } else {"
"0","             "
"0","             df_pooled <- "
"0","               df_pooled %>% "
"0","               filter(first!=""income"") %>% "
"0","               mutate(first = ifelse(model==""2b"", ""Model 2b: induced liberalism index"","
"0","                                     ""Model 2a: simple liberalism index"") %>% "
"0","                        factor())"
"0","             "
"0","           }"
"0","           "
"0","           p_pooled_main <- df_pooled %>% "
"0","             ggplot() +"
"0","             facet_grid(second~first, switch = ""y"","
"0","                        scales = ""fixed"","
"0","                        labeller = labeller(first = label_wrap_gen(width = 17), "
"0","                                            second = label_wrap_gen(width = 17))) +"
"0","             geom_point(aes(x = estimate, y = holder, col = second)) +"
"0","             geom_errorbar(aes(x = estimate, y = holder,"
"0","                               xmin = conf.low,"
"0","                               xmax = conf.high,"
"0","                               col = second),"
"0","                           size = 0.5,"
"0","                           width = 0.2) +"
"0","             geom_vline(xintercept = 0,"
"0","                        col = ""red"", "
"0","                        linetype = ""dashed"") +"
"0","             ggtitle(ifelse(z==1, ""Model 1"", ""Models 2a and 2b"")) +"
"0","             ylab("""") +"
"0","             theme_bw() +"
"0","             theme(legend.position = ""none"")"
"0","           "
"0","           if(z==1){"
"0","             p_pooled_main <- "
"0","               p_pooled_main +"
"0","               theme(axis.text.x = element_text(angle = 90)) +"
"0","             scale_x_continuous(trans = scales::pseudo_log_trans(sigma = 0.01),"
"0","                                breaks = c(-0.05, -0.025, 0, 0.025, 0.05, 0.1, 0.15, 0.25))"
"0","             "
"0","             grob <- ggplotGrob(p_pooled_main)"
"0","             "
"0","             grob$grobs[[which(grob$layout$name == sprintf(""panel-2-%s"","
"0","                                                           ifelse(z==1, ""7"", ""2"")))]] <- nullGrob()"
"0","             "
"0","             as_ggplot(grob)"
"0","             "
"0","           } else {"
"0","             "
"0","             p_pooled_main <- "
"0","               p_pooled_main +"
"0","               scale_x_continuous(breaks = seq(0, 0.5, 0.1))"
"0","             "
"0","           }"
"0","           "
"0","         })"
"2","Warning: Expected 2 pieces. Missing pieces filled with `NA` in 7 rows [1, 2, 3, 4, 5, 6, 7]."
"2","Warning: Expected 2 pieces. Missing pieces filled with `NA` in 4 rows [1, 2, 4, 5]."
"0","p_pooled_main <- ggarrange(plotlist = p_list, nrow = 2) %>% "
"0","  annotate_figure(top = text_grob(""Pooled estimates for main effects and income interactions"", "
"0","               color = ""black"", face = ""bold"", size = 14))"
"0",""
"0","p_pooled_main %>% "
"0","  write_rds(""saved/p_pooled_main.rds"")"
"0",""
